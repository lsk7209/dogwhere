# 클라우드플레어 Pages 설정
# pages.toml 파일

[build]
command = "npm run build"
cwd = "."

[build.environment_variables]
NODE_VERSION = "18"

[[redirects]]
from = "/admin"
to = "/admin/dashboard"
status = 301

[[redirects]]
from = "/api/*"
to = "/api/:splat"
status = 200

[functions]
# Workers Functions 설정
compatibility_date = "2024-10-28"
compatibility_flags = ["nodejs_compat"]

# 환경변수 설정
[env.production.vars]
NODE_ENV = "production"

# 헤더 설정
[[headers]]
for = "/*"
[headers.values]
X-Frame-Options = "DENY"
X-Content-Type-Options = "nosniff"
Referrer-Policy = "origin-when-cross-origin"
X-XSS-Protection = "1; mode=block"

# 캐시 설정
[[headers]]
for = "/static/*"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/_next/static/*"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/api/*"
[headers.values]
Cache-Control = "public, max-age=300, s-maxage=600"
